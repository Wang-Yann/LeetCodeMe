-- @Author        : Rock Wayne
-- @Created       : 2020-08-03 00:09:18
-- @Last Modified : 2020-08-03 00:09:18
--
-- #ä¹¦ç±è¡¨ Booksï¼š
-- #
-- # +----------------+---------+
-- #| Column Name    | Type    |
-- #+----------------+---------+
-- #| book_id        | int     |
-- #| name           | varchar |
-- #| available_from | date    |
-- #+----------------+---------+
-- #book_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚
-- #
-- #
-- # è®¢å•è¡¨ Ordersï¼š
-- #
-- # +----------------+---------+
-- #| Column Name    | Type    |
-- #+----------------+---------+
-- #| order_id       | int     |
-- #| book_id        | int     |
-- #| quantity       | int     |
-- #| dispatch_date  | date    |
-- #+----------------+---------+
-- #order_id æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®ã€‚
-- #book_id  æ˜¯ Books è¡¨çš„å¤–é”®ã€‚
-- #
-- #
-- #
-- #
-- # ä½ éœ€è¦å†™ä¸€æ®µ SQL å‘½ä»¤ï¼Œç­›é€‰å‡ºè¿‡å»ä¸€å¹´ä¸­è®¢å•æ€»é‡ å°‘äº10æœ¬ çš„ ä¹¦ç± ã€‚
-- #
-- # æ³¨æ„ï¼šä¸è€ƒè™‘ ä¸Šæ¶ï¼ˆavailable fromï¼‰è·ä»Š ä¸æ»¡ä¸€ä¸ªæœˆ çš„ä¹¦ç±ã€‚å¹¶ä¸” å‡è®¾ä»Šå¤©æ˜¯ 2019-06-23 ã€‚
-- #
-- #
-- #
-- # ä¸‹é¢æ˜¯æ ·ä¾‹è¾“å‡ºç»“æœï¼š
-- #
-- # Books è¡¨ï¼š
-- #+---------+--------------------+----------------+
-- #| book_id | name               | available_from |
-- #+---------+--------------------+----------------+
-- #| 1       | "Kalila And Demna" | 2010-01-01     |
-- #| 2       | "28 Letters"       | 2012-05-12     |
-- #| 3       | "The Hobbit"       | 2019-06-10     |
-- #| 4       | "13 Reasons Why"   | 2019-06-01     |
-- #| 5       | "The Hunger Games" | 2008-09-21     |
-- #+---------+--------------------+----------------+
-- #
-- #Orders è¡¨ï¼š
-- #+----------+---------+----------+---------------+
-- #| order_id | book_id | quantity | dispatch_date |
-- #+----------+---------+----------+---------------+
-- #| 1        | 1       | 2        | 2018-07-26    |
-- #| 2        | 1       | 1        | 2018-11-05    |
-- #| 3        | 3       | 8        | 2019-06-11    |
-- #| 4        | 4       | 6        | 2019-06-05    |
-- #| 5        | 4       | 5        | 2019-06-20    |
-- #| 6        | 5       | 9        | 2009-02-02    |
-- #| 7        | 5       | 8        | 2010-04-13    |
-- #+----------+---------+----------+---------------+
-- #
-- #Result è¡¨ï¼š
-- #+-----------+--------------------+
-- #| book_id   | name               |
-- #+-----------+--------------------+
-- #| 1         | "Kalila And Demna" |
-- #| 2         | "28 Letters"       |
-- #| 5         | "The Hunger Games" |
-- #+-----------+--------------------+
-- #
-- # ğŸ‘ 22 ğŸ‘ 0
--
--
--
-- #leetcode submit region begin(Prohibit modification and deletion)
-- # Write your MySQL query statement below
-- å®¹æ˜“å¿½ç•¥é”€é‡ä¸º0çš„ä¹¦ç±

select book_id,name from Books where available_from<=DATE_SUB('2019-06-23',INTERVAL 1  month ) and book_id not  in (
    select book_id  from Orders where dispatch_date>=DATE_SUB('2019-06-23',INTERVAL 1  year ) group by book_id
    having sum(quantity)>=10
);


-- #leetcode submit region end(Prohibit modification and deletion)
	
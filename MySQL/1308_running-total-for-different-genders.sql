-- @Author        : Rock Wayne
-- @Created       : 2020-08-05 23:03:55
-- @Last Modified : 2020-08-05 23:03:55
--
-- #è¡¨: Scores
-- #
-- #
-- #+---------------+---------+
-- #| Column Name   | Type    |
-- #+---------------+---------+
-- #| player_name   | varchar |
-- #| gender        | varchar |
-- #| day           | date    |
-- #| score_points  | int     |
-- #+---------------+---------+
-- #(gender, day)æ˜¯è¯¥è¡¨çš„ä¸»é”®
-- #ä¸€åœºæ¯”èµ›æ˜¯åœ¨å¥³é˜Ÿå’Œç”·é˜Ÿä¹‹é—´ä¸¾è¡Œçš„
-- #è¯¥è¡¨çš„æ¯ä¸€è¡Œè¡¨ç¤ºä¸€ä¸ªåå« (player_name) æ€§åˆ«ä¸º (gender) çš„å‚èµ›è€…åœ¨æŸä¸€å¤©èŽ·å¾—äº† (score_points) çš„åˆ†æ•°
-- #å¦‚æžœå‚èµ›è€…æ˜¯å¥³æ€§ï¼Œé‚£ä¹ˆ gender åˆ—ä¸º 'F'ï¼Œå¦‚æžœå‚èµ›è€…æ˜¯ç”·æ€§ï¼Œé‚£ä¹ˆ gender åˆ—ä¸º 'M'
-- #
-- #
-- #
-- #
-- # å†™ä¸€æ¡SQLè¯­å¥æŸ¥è¯¢æ¯ç§æ€§åˆ«åœ¨æ¯ä¸€å¤©çš„æ€»åˆ†ï¼Œå¹¶æŒ‰æ€§åˆ«å’Œæ—¥æœŸå¯¹æŸ¥è¯¢ç»“æžœæŽ’åº
-- #
-- # ä¸‹é¢æ˜¯æŸ¥è¯¢ç»“æžœæ ¼å¼çš„ä¾‹å­ï¼š
-- #
-- #
-- #Scoresè¡¨:
-- #+-------------+--------+------------+--------------+
-- #| player_name | gender | day        | score_points |
-- #+-------------+--------+------------+--------------+
-- #| Aron        | F      | 2020-01-01 | 17           |
-- #| Alice       | F      | 2020-01-07 | 23           |
-- #| Bajrang     | M      | 2020-01-07 | 7            |
-- #| Khali       | M      | 2019-12-25 | 11           |
-- #| Slaman      | M      | 2019-12-30 | 13           |
-- #| Joe         | M      | 2019-12-31 | 3            |
-- #| Jose        | M      | 2019-12-18 | 2            |
-- #| Priya       | F      | 2019-12-31 | 23           |
-- #| Priyanka    | F      | 2019-12-30 | 17           |
-- #+-------------+--------+------------+--------------+
-- #ç»“æžœè¡¨:
-- #+--------+------------+-------+
-- #| gender | day        | total |
-- #+--------+------------+-------+
-- #| F      | 2019-12-30 | 17    |
-- #| F      | 2019-12-31 | 40    |
-- #| F      | 2020-01-01 | 57    |
-- #| F      | 2020-01-07 | 80    |
-- #| M      | 2019-12-18 | 2     |
-- #| M      | 2019-12-25 | 13    |
-- #| M      | 2019-12-30 | 26    |
-- #| M      | 2019-12-31 | 29    |
-- #| M      | 2020-01-07 | 36    |
-- #+--------+------------+-------+
-- #å¥³æ€§é˜Ÿä¼:
-- #ç¬¬ä¸€å¤©æ˜¯ 2019-12-30ï¼ŒPriyanka èŽ·å¾— 17 åˆ†ï¼Œé˜Ÿä¼çš„æ€»åˆ†æ˜¯ 17 åˆ†
-- #ç¬¬äºŒå¤©æ˜¯ 2019-12-31, Priya èŽ·å¾— 23 åˆ†ï¼Œé˜Ÿä¼çš„æ€»åˆ†æ˜¯ 40 åˆ†
-- #ç¬¬ä¸‰å¤©æ˜¯ 2020-01-01, Aron èŽ·å¾— 17 åˆ†ï¼Œé˜Ÿä¼çš„æ€»åˆ†æ˜¯ 57 åˆ†
-- #ç¬¬å››å¤©æ˜¯ 2020-01-07, Alice èŽ·å¾— 23 åˆ†ï¼Œé˜Ÿä¼çš„æ€»åˆ†æ˜¯ 80 åˆ†
-- #ç”·æ€§é˜Ÿä¼ï¼š
-- #ç¬¬ä¸€å¤©æ˜¯ 2019-12-18, Jose èŽ·å¾— 2 åˆ†ï¼Œé˜Ÿä¼çš„æ€»åˆ†æ˜¯ 2 åˆ†
-- #ç¬¬äºŒå¤©æ˜¯ 2019-12-25, Khali èŽ·å¾— 11 åˆ†ï¼Œé˜Ÿä¼çš„æ€»åˆ†æ˜¯ 13 åˆ†
-- #ç¬¬ä¸‰å¤©æ˜¯ 2019-12-30, Slaman èŽ·å¾— 13 åˆ†ï¼Œé˜Ÿä¼çš„æ€»åˆ†æ˜¯ 26 åˆ†
-- #ç¬¬å››å¤©æ˜¯ 2019-12-31, Joe èŽ·å¾— 3 åˆ†ï¼Œé˜Ÿä¼çš„æ€»åˆ†æ˜¯ 29 åˆ†
-- #ç¬¬äº”å¤©æ˜¯ 2020-01-07, Bajrang èŽ·å¾— 7 åˆ†ï¼Œé˜Ÿä¼çš„æ€»åˆ†æ˜¯ 36 åˆ†
-- #
-- # ðŸ‘ 7 ðŸ‘Ž 0
--
--
--
-- #leetcode submit region begin(Prohibit modification and deletion)
-- # Write your MySQL query statement below
--
--


select gender, day, sum(score_points) over (partition by gender order by day) as total
from Scores
group by gender, day
order by gender, day;


-- #leetcode submit region end(Prohibit modification and deletion)

SELECT s1.gender, s1.day, SUM(s2.score_points) AS total
FROM Scores AS s1,
     Scores AS s2
WHERE s1.gender = s2.gender
  AND s1.day >= s2.day
GROUP BY s1.gender, s1.day
ORDER BY s1.gender, s1.day;


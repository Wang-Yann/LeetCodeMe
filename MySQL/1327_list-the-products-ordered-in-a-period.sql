-- @Author        : Rock Wayne
-- @Created       : 2020-08-05 23:43:47
-- @Last Modified : 2020-08-05 23:43:47
--
-- #è¡¨: Products
-- #
-- # +------------------+---------+
-- #| Column Name      | Type    |
-- #+------------------+---------+
-- #| product_id       | int     |
-- #| product_name     | varchar |
-- #| product_category | varchar |
-- #+------------------+---------+
-- #product_id æ˜¯è¯¥è¡¨ä¸»é”®ã€‚
-- #è¯¥è¡¨åŒ…å«è¯¥å…¬å¸äº§å“çš„æ•°æ®ã€‚
-- #
-- #
-- # è¡¨: Orders
-- #
-- # +---------------+---------+
-- #| Column Name   | Type    |
-- #+---------------+---------+
-- #| product_id    | int     |
-- #| order_date    | date    |
-- #| unit          | int     |
-- #+---------------+---------+
-- #è¯¥è¡¨æ— ä¸»é”®ï¼Œå¯èƒ½åŒ…å«é‡å¤è¡Œã€‚
-- #product_id æ˜¯è¡¨å• Products çš„å¤–é”®ã€‚
-- #unit æ˜¯åœ¨æ—¥æœŸ order_date å†…ä¸‹å•äº§å“çš„æ•°ç›®ã€‚
-- #
-- #
-- #
-- #
-- # å†™ä¸€ä¸ª SQL è¯­å¥ï¼Œè¦æ±‚èŽ·å–åœ¨ 2020 å¹´ 2 æœˆä»½ä¸‹å•çš„æ•°é‡ä¸å°‘äºŽ 100 çš„äº§å“çš„åå­—å’Œæ•°ç›®ã€‚
-- #
-- # è¿”å›žç»“æžœè¡¨å•çš„é¡ºåºæ— è¦æ±‚ã€‚
-- #
-- #
-- #
-- # æŸ¥è¯¢ç»“æžœçš„æ ¼å¼å¦‚ä¸‹ï¼š
-- #
-- # Products è¡¨:
-- #+-------------+-----------------------+------------------+
-- #| product_id  | product_name          | product_category |
-- #+-------------+-----------------------+------------------+
-- #| 1           | Leetcode Solutions    | Book             |
-- #| 2           | Jewels of Stringology | Book             |
-- #| 3           | HP                    | Laptop           |
-- #| 4           | Lenovo                | Laptop           |
-- #| 5           | Leetcode Kit          | T-shirt          |
-- #+-------------+-----------------------+------------------+
-- #
-- #Orders è¡¨:
-- #+--------------+--------------+----------+
-- #| product_id   | order_date   | unit     |
-- #+--------------+--------------+----------+
-- #| 1            | 2020-02-05   | 60       |
-- #| 1            | 2020-02-10   | 70       |
-- #| 2            | 2020-01-18   | 30       |
-- #| 2            | 2020-02-11   | 80       |
-- #| 3            | 2020-02-17   | 2        |
-- #| 3            | 2020-02-24   | 3        |
-- #| 4            | 2020-03-01   | 20       |
-- #| 4            | 2020-03-04   | 30       |
-- #| 4            | 2020-03-04   | 60       |
-- #| 5            | 2020-02-25   | 50       |
-- #| 5            | 2020-02-27   | 50       |
-- #| 5            | 2020-03-01   | 50       |
-- #+--------------+--------------+----------+
-- #
-- #Result è¡¨:
-- #+--------------------+---------+
-- #| product_name       | unit    |
-- #+--------------------+---------+
-- #| Leetcode Solutions | 130     |
-- #| Leetcode Kit       | 100     |
-- #+--------------------+---------+
-- #
-- #2020 å¹´ 2 æœˆä»½ä¸‹å• product_id = 1 çš„äº§å“çš„æ•°ç›®æ€»å’Œä¸º (60 + 70) = 130 ã€‚
-- #2020 å¹´ 2 æœˆä»½ä¸‹å• product_id = 2 çš„äº§å“çš„æ•°ç›®æ€»å’Œä¸º 80 ã€‚
-- #2020 å¹´ 2 æœˆä»½ä¸‹å• product_id = 3 çš„äº§å“çš„æ•°ç›®æ€»å’Œä¸º (2 + 3) = 5 ã€‚
-- #2020 å¹´ 2 æœˆä»½ product_id = 4 çš„äº§å“å¹¶æ²¡æœ‰ä¸‹å•ã€‚
-- #2020 å¹´ 2 æœˆä»½ä¸‹å• product_id = 5 çš„äº§å“çš„æ•°ç›®æ€»å’Œä¸º (50 + 50) = 100 ã€‚
-- #
-- # ðŸ‘ 6 ðŸ‘Ž 0
--
--
--
-- #leetcode submit region begin(Prohibit modification and deletion)
-- # Write your MySQL query statement below


select p.product_name, sum(o.unit) as unit
from Orders o
         join Products p on o.product_id = p.product_id
where date_format(o.order_date, '%Y-%m') = '2020-02'
group by o.product_id
having sum(o.unit) >= 100;

-- #leetcode submit region end(Prohibit modification and deletion)
	
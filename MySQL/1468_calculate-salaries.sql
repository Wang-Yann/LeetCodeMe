-- @Author        : Rock Wayne
-- @Created       : 2020-08-07 00:29:18
-- @Last Modified : 2020-08-07 00:29:18
--
-- #Salaries è¡¨ï¼š
-- #
-- #
-- #+---------------+---------+
-- #| Column Name   | Type    |
-- #+---------------+---------+
-- #| company_id    | int     |
-- #| employee_id   | int     |
-- #| employee_name | varchar |
-- #| salary        | int     |
-- #+---------------+---------+
-- #(company_id, employee_id) æ˜¯è¿™ä¸ªè¡¨çš„ä¸»é”®
-- #è¿™ä¸ªè¡¨åŒ…æ‹¬å‘˜å·¥çš„company id, id, name å’Œ salary
-- #
-- #
-- #
-- #
-- # å†™ä¸€æ¡æŸ¥è¯¢ SQL æ¥æŸ¥æ‰¾æ¯ä¸ªå‘˜å·¥çš„ç¨ŽåŽå·¥èµ„
-- #
-- # æ¯ä¸ªå…¬å¸çš„ç¨ŽçŽ‡è®¡ç®—ä¾ç…§ä»¥ä¸‹è§„åˆ™
-- #
-- #
-- # å¦‚æžœè¿™ä¸ªå…¬å¸å‘˜å·¥æœ€é«˜å·¥èµ„ä¸åˆ° 1000 ï¼Œç¨ŽçŽ‡ä¸º 0%
-- # å¦‚æžœè¿™ä¸ªå…¬å¸å‘˜å·¥æœ€é«˜å·¥èµ„åœ¨ 1000 åˆ° 10000 ä¹‹é—´ï¼Œç¨ŽçŽ‡ä¸º 24%
-- # å¦‚æžœè¿™ä¸ªå…¬å¸å‘˜å·¥æœ€é«˜å·¥èµ„å¤§äºŽ 10000 ï¼Œç¨ŽçŽ‡ä¸º 49%
-- #
-- #
-- # æŒ‰ä»»æ„é¡ºåºè¿”å›žç»“æžœï¼Œç¨ŽåŽå·¥èµ„ç»“æžœå–æ•´
-- #
-- #
-- #
-- # ç»“æžœè¡¨æ ¼å¼å¦‚ä¸‹ä¾‹æ‰€ç¤ºï¼š
-- #
-- #
-- #Salaries è¡¨ï¼š
-- #+------------+-------------+---------------+--------+
-- #| company_id | employee_id | employee_name | salary |
-- #+------------+-------------+---------------+--------+
-- #| 1          | 1           | Tony          | 2000   |
-- #| 1          | 2           | Pronub        | 21300  |
-- #| 1          | 3           | Tyrrox        | 10800  |
-- #| 2          | 1           | Pam           | 300    |
-- #| 2          | 7           | Bassem        | 450    |
-- #| 2          | 9           | Hermione      | 700    |
-- #| 3          | 7           | Bocaben       | 100    |
-- #| 3          | 2           | Ognjen        | 2200   |
-- #| 3          | 13          | Nyancat       | 3300   |
-- #| 3          | 15          | Morninngcat   | 1866   |
-- #+------------+-------------+---------------+--------+
-- #
-- #Result è¡¨ï¼š
-- #+------------+-------------+---------------+--------+
-- #| company_id | employee_id | employee_name | salary |
-- #+------------+-------------+---------------+--------+
-- #| 1          | 1           | Tony          | 1020   |
-- #| 1          | 2           | Pronub        | 10863  |
-- #| 1          | 3           | Tyrrox        | 5508   |
-- #| 2          | 1           | Pam           | 300    |
-- #| 2          | 7           | Bassem        | 450    |
-- #| 2          | 9           | Hermione      | 700    |
-- #| 3          | 7           | Bocaben       | 76     |
-- #| 3          | 2           | Ognjen        | 1672   |
-- #| 3          | 13          | Nyancat       | 2508   |
-- #| 3          | 15          | Morninngcat   | 5911   |
-- #+------------+-------------+---------------+--------+
-- #å¯¹äºŽå…¬å¸ 1 ï¼Œæœ€é«˜å·¥èµ„æ˜¯ 21300 ï¼Œå…¶æ¯ä¸ªå‘˜å·¥çš„ç¨ŽçŽ‡ä¸º 49%
-- #å¯¹äºŽå…¬å¸ 2 ï¼Œæœ€é«˜å·¥èµ„æ˜¯ 700 ï¼Œå…¶æ¯ä¸ªå‘˜å·¥ç¨ŽçŽ‡ä¸º 0%
-- #å¯¹äºŽå…¬å¸ 3 ï¼Œæœ€é«˜å·¥èµ„æ˜¯ 7777 ï¼Œå…¶æ¯ä¸ªå‘˜å·¥ç¨ŽçŽ‡æ˜¯ 24%
-- #ç¨ŽåŽå·¥èµ„è®¡ç®— = å·¥èµ„ - ( ç¨ŽçŽ‡ / 100ï¼‰*å·¥èµ„
-- #å¯¹äºŽä¸Šè¿°æ¡ˆä¾‹ï¼ŒMorninngcat çš„ç¨ŽåŽå·¥èµ„ = 7777 - 7777 * ( 24 / 100) = 7777 - 1866.48 = 5910.52
-- # ï¼Œå–æ•´ä¸º 5911
-- #
-- # ðŸ‘ 0 ðŸ‘Ž 0
--
--
--
-- #leetcode submit region begin(Prohibit modification and deletion)
-- # Write your MySQL query statement below

select s.company_id,
       s.employee_id,
       s.employee_name,
       round(s.salary * (1 - rate)) as salary
from Salaries as s
         left join (
    select company_id,
           (case
                when max(salary) > 10000 then 0.49
                when max(salary) < 1000 then 0
                else 0.24
               end
               ) as rate
    from Salaries
    group by company_id
) as sc on s.company_id = sc.company_id;


-- #leetcode submit region end(Prohibit modification and deletion)
	
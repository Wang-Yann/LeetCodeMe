#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Author        : Rock Wayne 
# @Created       : 2020-07-23 23:27:22
# @Last Modified : 2020-07-23 23:27:22
# @Mail          : lostlorder@gmail.com
# @Version       : 1.0.0

"""
# åŠ›æ‰£æƒ³è®©ä¸€ä¸ªæœ€ä¼˜ç§€çš„å‘˜å·¥åœ¨ N ä¸ªåŸå¸‚é—´æ—…è¡Œæ¥æ”¶é›†ç®—æ³•é—®é¢˜ã€‚ ä½†åªå·¥ä½œä¸ç©è€ï¼Œèªæ˜çš„å­©å­ä¹Ÿä¼šå˜å‚»ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥åœ¨æŸäº›ç‰¹å®šçš„åŸå¸‚å’Œæ˜ŸæœŸä¼‘å‡ã€‚æ‚¨çš„å·¥ä½œå°±æ˜¯å®‰æ’æ—…è¡Œ
# ä½¿å¾—æœ€å¤§åŒ–ä½ å¯ä»¥ä¼‘å‡çš„å¤©æ•°ï¼Œä½†æ˜¯æ‚¨éœ€è¦éµå®ˆä¸€äº›è§„åˆ™å’Œé™åˆ¶ã€‚ 
# 
#  è§„åˆ™å’Œé™åˆ¶ï¼š 
# 
#  
#  æ‚¨åªèƒ½åœ¨ N ä¸ªåŸå¸‚ä¹‹é—´æ—…è¡Œï¼Œç”¨ 0 åˆ° N-1 çš„ç´¢å¼•è¡¨ç¤ºã€‚ä¸€å¼€å§‹ï¼Œæ‚¨åœ¨ç´¢å¼•ä¸º0çš„åŸå¸‚ï¼Œå¹¶ä¸”é‚£å¤©æ˜¯æ˜ŸæœŸä¸€ã€‚ 
#  è¿™äº›åŸå¸‚é€šè¿‡èˆªç­ç›¸è¿ã€‚è¿™äº›èˆªç­ç”¨ N*N çŸ©é˜µ flightsï¼ˆä¸ä¸€å®šæ˜¯å¯¹ç§°çš„ï¼‰è¡¨ç¤ºï¼Œflights[i][j] ä»£è¡¨åŸå¸‚iåˆ°åŸå¸‚jçš„èˆªç©ºçŠ¶æ€ã€‚å¦‚æœæ²¡æœ‰åŸ
# å¸‚iåˆ°åŸå¸‚jçš„èˆªç­ï¼Œflights[i][j] = 0ï¼›å¦åˆ™ï¼Œflights[i][j] = 1ã€‚åŒæ—¶ï¼Œå¯¹äºæ‰€æœ‰çš„iï¼Œflights[i][i] = 0ã€‚ 
#  æ‚¨æ€»å…±æœ‰ K å‘¨ï¼ˆæ¯å‘¨7å¤©ï¼‰çš„æ—¶é—´æ—…è¡Œã€‚æ‚¨æ¯å¤©æœ€å¤šåªèƒ½ä¹˜åä¸€æ¬¡èˆªç­ï¼Œå¹¶ä¸”åªèƒ½åœ¨æ¯å‘¨çš„æ˜ŸæœŸä¸€ä¸Šåˆä¹˜åèˆªç­ã€‚ç”±äºé£è¡Œæ—¶é—´å¾ˆçŸ­ï¼Œæˆ‘ä»¬ä¸è€ƒè™‘é£è¡Œæ—¶é—´çš„å½±å“ã€‚ 
#  å¯¹äºæ¯ä¸ªåŸå¸‚ï¼Œä¸åŒçš„æ˜ŸæœŸæ‚¨ä¼‘å‡å¤©æ•°æ˜¯ä¸åŒçš„ï¼Œç»™å®šä¸€ä¸ª N*K çŸ©é˜µ days ä»£è¡¨è¿™ç§é™åˆ¶ï¼Œdays[i][j] ä»£è¡¨æ‚¨åœ¨ç¬¬jä¸ªæ˜ŸæœŸåœ¨åŸå¸‚ièƒ½ä¼‘å‡çš„æœ€é•¿å¤©
# æ•°ã€‚ 
#  
# 
#  ç»™å®š flights çŸ©é˜µå’Œ days çŸ©é˜µï¼Œæ‚¨éœ€è¦è¾“å‡º K å‘¨å†…å¯ä»¥ä¼‘å‡çš„æœ€é•¿å¤©æ•°ã€‚ 
# 
#  ç¤ºä¾‹ 1: 
# 
#  è¾“å…¥:flights = [[0,1,1],[1,0,1],[1,1,0]], days = [[1,3,1],[6,0,3],[3,3,3]]
# è¾“å‡º: 12
# è§£é‡Š: 
# Ans = 6 + 3 + 3 = 12. 
# 
# æœ€å¥½çš„ç­–ç•¥ä¹‹ä¸€ï¼š
# ç¬¬ä¸€ä¸ªæ˜ŸæœŸ : æ˜ŸæœŸä¸€ä»åŸå¸‚0é£åˆ°åŸå¸‚1ï¼Œç©6å¤©ï¼Œå·¥ä½œ1å¤©ã€‚ 
# ï¼ˆè™½ç„¶ä½ æ˜¯ä»åŸå¸‚0å¼€å§‹ï¼Œä½†å› ä¸ºæ˜¯æ˜ŸæœŸä¸€ï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é£åˆ°å…¶ä»–åŸå¸‚ã€‚ï¼‰ 
# ç¬¬äºŒä¸ªæ˜ŸæœŸ : æ˜ŸæœŸä¸€ä»åŸå¸‚1é£åˆ°åŸå¸‚2ï¼Œç©3å¤©ï¼Œå·¥ä½œ4å¤©ã€‚
# ç¬¬ä¸‰ä¸ªæ˜ŸæœŸ : å‘†åœ¨åŸå¸‚2ï¼Œç©3å¤©ï¼Œå·¥ä½œ4å¤©ã€‚
#  
# 
#  
# 
#  ç¤ºä¾‹ 2: 
# 
#  è¾“å…¥:flights = [[0,0,0],[0,0,0],[0,0,0]], days = [[1,1,1],[7,7,7],[7,7,7]]
# è¾“å‡º: 3
# è§£é‡Š: 
# Ans = 1 + 1 + 1 = 3. 
# 
# ç”±äºæ²¡æœ‰èˆªç­å¯ä»¥è®©æ‚¨é£åˆ°å…¶ä»–åŸå¸‚ï¼Œä½ å¿…é¡»åœ¨åŸå¸‚0å‘†æ•´æ•´3ä¸ªæ˜ŸæœŸã€‚ 
# å¯¹äºæ¯ä¸€ä¸ªæ˜ŸæœŸï¼Œä½ åªæœ‰ä¸€å¤©æ—¶é—´ç©ï¼Œå‰©ä¸‹å…­å¤©éƒ½è¦å·¥ä½œã€‚ 
# æ‰€ä»¥æœ€å¤§ä¼‘å‡å¤©æ•°ä¸º3.
#  
# 
#  
# 
#  ç¤ºä¾‹ 3: 
# 
#  è¾“å…¥:flights = [[0,1,1],[1,0,1],[1,1,0]], days = [[7,0,0],[0,7,0],[0,0,7]]
# è¾“å‡º: 21
# è§£é‡Š:
# Ans = 7 + 7 + 7 = 21
# 
# æœ€å¥½çš„ç­–ç•¥ä¹‹ä¸€æ˜¯ï¼š
# ç¬¬ä¸€ä¸ªæ˜ŸæœŸ : å‘†åœ¨åŸå¸‚0ï¼Œç©7å¤©ã€‚ 
# ç¬¬äºŒä¸ªæ˜ŸæœŸ : æ˜ŸæœŸä¸€ä»åŸå¸‚0é£åˆ°åŸå¸‚1ï¼Œç©7å¤©ã€‚
# ç¬¬ä¸‰ä¸ªæ˜ŸæœŸ : æ˜ŸæœŸä¸€ä»åŸå¸‚1é£åˆ°åŸå¸‚2ï¼Œç©7å¤©ã€‚
#  
# 
#  
# 
#  æ³¨æ„: 
# 
#  
#  N å’Œ K éƒ½æ˜¯æ­£æ•´æ•°ï¼Œåœ¨ [1, 100] èŒƒå›´å†…ã€‚ 
#  çŸ©é˜µ flights çš„æ‰€æœ‰å€¼éƒ½æ˜¯ [0, 1] èŒƒå›´å†…çš„æ•´æ•°ã€‚ 
#  çŸ©é˜µ days çš„æ‰€æœ‰å€¼éƒ½æ˜¯ [0, 7] èŒƒå›´å†…çš„æ•´æ•°ã€‚ 
#  è¶…è¿‡ä¼‘å‡å¤©æ•°æ‚¨ä»å¯ä»¥å‘†åœ¨é‚£ä¸ªåŸå¸‚ï¼Œä½†æ˜¯åœ¨é¢å¤–çš„æ—¥å­æ‚¨éœ€è¦ å·¥ä½œ ï¼Œè¿™äº›æ—¥å­ä¸ä¼šç®—åšä¼‘å‡æ—¥ã€‚ 
#  å¦‚æœæ‚¨ä»åŸå¸‚Aé£å¾€åŸå¸‚Bå¹¶åœ¨å½“å¤©ä¼‘å‡æ—¥ï¼Œè¿™ä¸ªä¼‘å‡ä¼šè¢«ç®—ä½œæ˜¯åŸå¸‚Bçš„ä¼‘å‡æ—¥ã€‚ 
#  æˆ‘ä»¬ä¸è€ƒè™‘é£è¡Œæ—¶é—´å¯¹è®¡ç®—ä¼‘å‡æ—¥çš„å½±å“ã€‚ 
#  
# 
#  
#  Related Topics åŠ¨æ€è§„åˆ’ 
#  ğŸ‘ 14 ğŸ‘ 0

"""

import functools
from typing import List

import pytest


# leetcode submit region begin(Prohibit modification and deletion)
class Solution:

    def maxVacationDays(self, flights: List[List[int]], days: List[List[int]]) -> int:
        """
        ç¬¬ weekno  å‘¨åœ¨  cur_city åŸå¸‚æ—¶ï¼Œæ‰€èƒ½æœ€å¤§åŒ–çš„ä¼‘å‡å¤©æ•°
        æ¯æ¬¡æ–¹æ³•è°ƒç”¨ï¼Œéå†æ‰€æœ‰çš„åŸå¸‚ï¼ˆç”¨ i æ¥è¡¨ç¤ºï¼‰æ‰¾åˆ°è·Ÿå½“å‰åŸå¸‚ç›¸è¿çš„åŸå¸‚ã€‚è¿™æ—¶å€™æœ‰ä¸¤ä¸ªé€‰æ‹©ï¼Œ
        ç•™åœ¨å½“å‰åŸå¸‚æˆ–è€…é£åˆ°ç›¸è¿çš„åŸå¸‚ï¼Œç”¨ j æ¥è¡¨ç¤ºä¸‹å‘¨æ‰€åœ¨çš„åŸå¸‚ã€‚éšåï¼Œå‘¨æ•°åŠ  1 å¹¶è¿›è¡Œä¸‹ä¸€æ¬¡é€’å½’ï¼Œæ ¹æ®é€’å½’ç»“æœè®¡ç®—ä¼‘å‡å¤©æ•°ã€‚
        ä¼‘å‡å¤©æ•°æ ¹æ®ä¸‹é¢å…¬å¼æ¥è®¡ç®—ï¼š days[j][weekno] + dfs(j, weekno + 1)ã€‚
        æœ€åï¼Œå°†ä¼‘å‡å¤©æ•°ä¸å…¨å±€æœ€å¤§ä¼‘å‡å¤©æ•°ç›¸æ¯”è¾ƒï¼Œå°†å…¨å±€æœ€å¤§ä¼‘å‡å¤©æ•°æ›´æ–°ä¸ºä¸¤è€…ä¸­çš„æœ€å¤§å€¼


        """
        K = len(days[0])
        N = len(flights)

        @functools.lru_cache(None)
        def dp(cur_city, weekno):
            if weekno == K:
                return 0
            max_val = 0
            for i in range(N):
                if flights[cur_city][i] == 1 or i == cur_city:
                    val = days[i][weekno] + dp(i, weekno + 1)
                    max_val = max(max_val, val)
            return max_val

        return dp(0, 0)


# leetcode submit region end(Prohibit modification and deletion)


@pytest.mark.parametrize("kwargs,expected", [
    [dict(flights=[[0, 1, 1], [1, 0, 1], [1, 1, 0]], days=[[1, 3, 1], [6, 0, 3], [3, 3, 3]]), 12],

    pytest.param(dict(flights=[[0, 0, 0], [0, 0, 0], [0, 0, 0]], days=[[1, 1, 1], [7, 7, 7], [7, 7, 7]]), 3),
    pytest.param(dict(flights=[[0, 1, 1], [1, 0, 1], [1, 1, 0]], days=[[7, 0, 0], [0, 7, 0], [0, 0, 7]]), 21),
])
def test_solutions(kwargs, expected):
    assert Solution().maxVacationDays(**kwargs) == expected


if __name__ == '__main__':
    pytest.main(["-q", "--color=yes", "--capture=tee-sys", __file__])

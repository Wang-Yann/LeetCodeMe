#!/usr/bin/env python
# -*- coding: utf-8 -*-
# @Author        : Rock Wayne 
# @Created       : 2021-02-22 03:55:45
# @Last Modified : 2021-02-22 03:55:45
# @Mail          : lostlorder@gmail.com
# @Version       : alpha-1.0

"""
# ç»™ä½ ä¸€ä¸ªæ•°ç»„ nums è¡¨ç¤º 1 åˆ° n çš„ä¸€ä¸ªæ’åˆ—ã€‚æˆ‘ä»¬æŒ‰ç…§å…ƒç´ åœ¨ nums ä¸­çš„é¡ºåºä¾æ¬¡æ’å…¥ä¸€ä¸ªåˆå§‹ä¸ºç©ºçš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼ˆBSTï¼‰ã€‚è¯·ä½ ç»Ÿè®¡å°† nums é‡
# æ–°æ’åºåï¼Œç»Ÿè®¡æ»¡è¶³å¦‚ä¸‹æ¡ä»¶çš„æ–¹æ¡ˆæ•°ï¼šé‡æ’åå¾—åˆ°çš„äºŒå‰æŸ¥æ‰¾æ ‘ä¸ nums åŸæœ¬æ•°å­—é¡ºåºå¾—åˆ°çš„äºŒå‰æŸ¥æ‰¾æ ‘ç›¸åŒã€‚ 
# 
#  æ¯”æ–¹è¯´ï¼Œç»™ä½  nums = [2,1,3]ï¼Œæˆ‘ä»¬å¾—åˆ°ä¸€æ£µ 2 ä¸ºæ ¹ï¼Œ1 ä¸ºå·¦å­©å­ï¼Œ3 ä¸ºå³å­©å­çš„æ ‘ã€‚æ•°ç»„ [2,3,1] ä¹Ÿèƒ½å¾—åˆ°ç›¸åŒçš„ BSTï¼Œä½† [3
# ,2,1] ä¼šå¾—åˆ°ä¸€æ£µä¸åŒçš„ BST ã€‚ 
# 
#  è¯·ä½ è¿”å›é‡æ’ nums åï¼Œä¸åŸæ•°ç»„ nums å¾—åˆ°ç›¸åŒäºŒå‰æŸ¥æ‰¾æ ‘çš„æ–¹æ¡ˆæ•°ã€‚ 
# 
#  ç”±äºç­”æ¡ˆå¯èƒ½ä¼šå¾ˆå¤§ï¼Œè¯·å°†ç»“æœå¯¹ 10^9 + 7 å–ä½™æ•°ã€‚ 
# 
#  
# 
#  ç¤ºä¾‹ 1ï¼š 
# 
#  
# 
#  è¾“å…¥ï¼šnums = [2,1,3]
# è¾“å‡ºï¼š1
# è§£é‡Šï¼šæˆ‘ä»¬å°† nums é‡æ’ï¼Œ [2,3,1] èƒ½å¾—åˆ°ç›¸åŒçš„ BST ã€‚æ²¡æœ‰å…¶ä»–å¾—åˆ°ç›¸åŒ BST çš„æ–¹æ¡ˆäº†ã€‚
#  
# 
#  ç¤ºä¾‹ 2ï¼š 
# 
#  
# 
#  è¾“å…¥ï¼šnums = [3,4,5,1,2]
# è¾“å‡ºï¼š5
# è§£é‡Šï¼šä¸‹é¢ 5 ä¸ªæ•°ç»„ä¼šå¾—åˆ°ç›¸åŒçš„ BSTï¼š
# [3,1,2,4,5]
# [3,1,4,2,5]
# [3,1,4,5,2]
# [3,4,1,2,5]
# [3,4,1,5,2]
#  
# 
#  ç¤ºä¾‹ 3ï¼š 
# 
#  
# 
#  è¾“å…¥ï¼šnums = [1,2,3]
# è¾“å‡ºï¼š0
# è§£é‡Šï¼šæ²¡æœ‰åˆ«çš„æ’åˆ—é¡ºåºèƒ½å¾—åˆ°ç›¸åŒçš„ BST ã€‚
#  
# 
#  ç¤ºä¾‹ 4ï¼š 
# 
#  
# 
#  è¾“å…¥ï¼šnums = [3,1,2,5,4,6]
# è¾“å‡ºï¼š19
#  
# 
#  ç¤ºä¾‹ 5ï¼š 
# 
#  è¾“å…¥ï¼šnums = [9,4,2,1,3,6,5,7,8,14,11,10,12,13,16,15,17,18]
# è¾“å‡ºï¼š216212978
# è§£é‡Šï¼šå¾—åˆ°ç›¸åŒ BST çš„æ–¹æ¡ˆæ•°æ˜¯ 3216212999ã€‚å°†å®ƒå¯¹ 10^9 + 7 å–ä½™åå¾—åˆ° 216212978ã€‚
#  
# 
#  
# 
#  æç¤ºï¼š 
# 
#  
#  1 <= nums.length <= 1000 
#  1 <= nums[i] <= nums.length 
#  nums ä¸­æ‰€æœ‰æ•° äº’ä¸ç›¸åŒ ã€‚ 
#  
#  Related Topics åŠ¨æ€è§„åˆ’ 
#  ğŸ‘ 24 ğŸ‘ 0

"""

from typing import List

import pytest
from scipy.special import comb


# leetcode submit region begin(Prohibit modification and deletion)

class Solution:
    # math.comb()Pythonä¸­çš„methodæ–¹æ³•ç”¨æ–¼ç²å–å¾nå€‹é …ç›®ä¸­é¸æ“‡kå€‹é …ç›®(ä¸é‡è¤‡ä¸”ç„¡é †åº)çš„æ–¹æ³•æ•¸é‡ã€‚
    # å®ƒæœ¬è³ªä¸Šè©•ä¼°ç‚ºnï¼ /(kï¼*(n-k)ï¼)å®ƒä¹Ÿè¢«ç¨±ç‚ºäºŒé …å¼ä¿‚æ•¸ï¼Œå› ç‚ºå®ƒç­‰æ•ˆæ–¼è¡¨é”å¼(1 + x)çš„å¤šé …å¼å±•é–‹ä¸­çš„k-thé …çš„ä¿‚æ•¸nã€‚
    # æ­¤æ–¹æ³•æ˜¯Pythonç‰ˆæœ¬3.8ä¸­çš„æ–°å¢åŠŸèƒ½
    """
    é¦–å…ˆæˆ‘ä»¬å‘ç°ä¸€ä¸ªå­æ ‘æ‰€æœ‰å¯èƒ½çš„æ–¹æ¡ˆæ•°æ˜¯è¯¥å­æ ‘æ‰€æœ‰èŠ‚ç‚¹ï¼ˆé™¤å»æ ¹èŠ‚ç‚¹ï¼‰çš„å…¨æ’åˆ—
    ä½†æ˜¯ç”±äºåˆ†ä¸ºå·¦å­æ ‘å³å­æ ‘ï¼Œæ‰€ä»¥å…¨æ’åˆ—è‚¯å®šæ˜¯å¤šç®—çš„ã€‚æ‰€ä»¥è®©æˆ‘ä»¬æŠŠå·¦å³å­æ ‘åˆ†å¼€ï¼Œé‚£ä¹ˆå°±æ˜¯ä¸€ä¸ªç»„åˆ(n,l)
    å³åœ¨æ‰€æœ‰å­èŠ‚ç‚¹ä¸­é€‰å‡ºå·¦å­æ ‘èŠ‚ç‚¹çš„æ–¹æ¡ˆæ•°ï¼ˆæ ¹æ®ç»„åˆç‰¹æ€§ï¼Œé€‰å³å­æ ‘æ˜¯ç­‰ä»·çš„ï¼‰ã€‚
    ä½†æ˜¯æ­¤æ—¶æˆ‘ä»¬å‘ç°åˆå°‘ç®—äº†å·¦å­æ ‘å’Œå³å­æ ‘çš„æ’åˆ—ã€‚è¿™é‡Œçš„æ’åˆ—å¹¶ä¸æ˜¯å…¨æ’åˆ—ï¼Œè€Œæ˜¯æ–¹æ¡ˆæ•°ï¼

    """

    def numOfWays(self, nums: List[int]) -> int:
        def dp(arr):
            if len(arr) < 3:
                return 1
            left = [num for num in arr if num < arr[0]]
            right = [num for num in arr if num > arr[0]]
            l, r = dp(left), dp(right)
            res = comb(len(arr) - 1, len(left)) * l * r
            return res

        return (dp(nums) - 1) % (10 ** 9 + 7)


# leetcode submit region end(Prohibit modification and deletion)


@pytest.mark.parametrize("kw,expected", [
    [dict(nums=[2, 1, 3]), 1],
    [dict(nums=[3, 4, 5, 1, 2]), 5],
    [dict(nums=[1, 2, 3]), 0],
    [dict(nums=[3, 1, 2, 5, 4, 6]), 19],
    [dict(nums=[9, 4, 2, 1, 3, 6, 5, 7, 8, 14, 11, 10, 12, 13, 16, 15, 17, 18]), 216212978],
])
def test_solutions(kw, expected):
    assert Solution().numOfWays(**kw) == expected


if __name__ == '__main__':
    pytest.main(["-q", "--color=yes", "--capture=no", __file__])
